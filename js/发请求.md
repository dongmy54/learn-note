### 发请求
#### 1.异步ajax请求
```ruby
# 在路由上禁用 csrf
  post 'ajax_test', :provides => :js, :csrf_protection => false do
     @use_name = params[:use_name]   # 像正常参数获取一样
     {:name => @use_name}.to_json    # 返回json数据
  end
```

```html
<input type="input" name="use_name" value="bkj">
<button class="btn btn-success" id='send_ajax'>sdaf</button>

<script>
  // 发送ajax请求
  $("#send_ajax").click(function(){
    // 获取input中值
    var use_name = $("input[name=use_name]").val();
    // 在ajax中用逗号 js中用分号；
    $.ajax({
      url: 'ajax_test',
      type: 'POST',
      // 传入值
      data: {use_name: use_name},
      dataType: 'json',
      success: function(data) {
        // 获取到的data 是 请求传回的json数据，其中数据用字符串的方式取出
        console.log(data['name']);
      }
    })
  })

</script> 
```
#### 2.get请求 回调函数
```ruby
 # 初始进入页面
 get :jq_get_test do
    @get_url = 'jq_get'   # get 的url

    render 'main/jq_get_test'
  end

  # get 的路由
  get :jq_get, :provides => :json do   # 一定要是json格式，不然回调函数不会执行
    {:success => true}.to_json
  end
```
```html
<button class="btn btn-success" id='send_get'>sdaf</button>

<script>
  // 发送get 请求
  $("#send_get").click(function(){
    // 获取get_url erb模版中
    var get_url = "<%= @get_url %>";
    // 请求
    $.get(get_url,function(data,status) {
      // data 请求返回的数据 (如： {'success': true})
      // status 请求的状态 （success 等等）
      // data.success data['success'] 它是对象（等价）
      if (data.success == true) {
        console.log('成功了');
      }
    })
  })
</script>

```
#### 补充：
1. 在erb模版下 和 haml模版下，js中获取实例变量方式不同
```js
// erb中
var name = "<%= @name %>"
// haml中
var name = "#{@name}"
``` 
2. 关于发送(相对路径）url
```
一、默认情况下：是续接当前页面的上一层级

    当前页：https:example.com/hu/bar.html
    你的url写的: 'kong'

则  请求页为： https:example.com/hu/kong.html


二、可以在url前加上/回到域名的根地址

    当前页：https:example.com/hu/bar.html
    你的url写的: '/kong'

则  请求页为： https:example.com/kong.html


```
